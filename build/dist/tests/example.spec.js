import { expect, test } from '@playwright/test';
test.beforeEach(async ({ page }) => {
    test.setTimeout(60000);
    await page.addInitScript({ path: 'build/dist/src/XrmEx.js' });
    var env = JSON.parse(process.env.ENV_VAR_JSON);
    await page.goto(env.CONTACT_RECORD_URL);
    await page.getByLabel('First Name').waitFor({ state: 'visible' });
    await getModel(page);
});
test.describe('Test Field Class', () => {
    test('Get and Set Value', async ({ page }) => {
        var response = await page.evaluate(() => {
            model.fields.Firstname.Value = 'John';
            return model.fields.Firstname.Value;
        });
        expect(response).toBe('John'); //Test
    });
    test('Hide and Show Field', async ({ page }) => {
        var response = await page.evaluate(() => {
            model.fields.Firstname.setVisible(false);
            let isVisible;
            model.fields.Firstname.controls.forEach(c => isVisible = c.getVisible());
            return isVisible;
        });
        expect(response).toBe(false);
        var response2 = await page.evaluate(() => {
            model.fields.Firstname.setVisible(true);
            let isVisible;
            model.fields.Firstname.controls.forEach(c => isVisible = c.getVisible());
            return isVisible;
        });
        expect(response2).toBe(true);
    });
});
var model;
async function getModel(page) {
    return await page.evaluate(() => {
        XrmEx.Form.formContext = window.XrmEx.Form.executionContext;
        class Fields {
            Firstname = new XrmEx.TextField("firstname");
            Lastname = new XrmEx.TextField("lastname");
            JobTitle = new XrmEx.TextField("jobtitle");
            PreferredContactMethod = new XrmEx.OptionsetField("preferredcontactmethodcode", {
                Any: 1,
                Email: 2,
                Phone: 3,
                Fax: 4,
                Mail: 5,
            });
            Customer = new XrmEx.LookupField("parentcustomerid");
            BusinessPhone = new XrmEx.TextField("telephone1");
            Gender = new XrmEx.OptionsetField("gendercode");
            Email = new XrmEx.TextField("emailaddress1");
            MobilePhone = new XrmEx.TextField("mobilephone");
            Owner = new XrmEx.LookupField("ownerid");
            DoNotEmail = new XrmEx.BooleanField("donotemail");
            MaritalStatus = new XrmEx.OptionsetField("familystatuscode");
            SpousePartnerName = new XrmEx.TextField("spousesname");
            Birthday = new XrmEx.DateField("birthdate");
        }
        class Tabs {
            General = new XrmEx.Tab("tab1", {
                Section1: new XrmEx.Section("section1"),
                Section2: new XrmEx.Section("section2"),
            });
            Details = new XrmEx.Tab("tab2", {
                Section1: new XrmEx.Section("section1"),
                Section2: new XrmEx.Section("section2"),
            });
        }
        class Grids {
            ContactSubgrid = new XrmEx.GridControl("Test");
        }
        var model = {
            fields: new Fields(),
            tabs: new Tabs(),
            grids: new Grids(),
        };
        window.model = model;
        return model;
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhhbXBsZS5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vdGVzdHMvZXhhbXBsZS5zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQVEsSUFBSSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFJdEQsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFO0lBQ2pDLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdkIsTUFBTSxJQUFJLENBQUMsYUFBYSxDQUFDLEVBQUUsSUFBSSxFQUFFLHlCQUF5QixFQUFFLENBQUMsQ0FBQztJQUM5RCxJQUFJLEdBQUcsR0FBYyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDMUQsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0lBQ3hDLE1BQU0sSUFBSSxDQUFDLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQztJQUNsRSxNQUFNLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN2QixDQUFDLENBQUMsQ0FBQztBQUNILElBQUksQ0FBQyxRQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFO0lBQ3JDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxLQUFLLEVBQUUsRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFO1FBQzNDLElBQUksUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEVBQUU7WUFDdEMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQztZQUN0QyxPQUFPLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztR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LCBQYWdlLCB0ZXN0IH0gZnJvbSAnQHBsYXl3cmlnaHQvdGVzdCc7XG5cbmltcG9ydCB7IENSTUNvbmZpZyB9IGZyb20gJy4vYXV0aC5zZXR1cCc7XG5cbnRlc3QuYmVmb3JlRWFjaChhc3luYyAoeyBwYWdlIH0pID0+IHtcbiAgdGVzdC5zZXRUaW1lb3V0KDYwMDAwKTtcbiAgYXdhaXQgcGFnZS5hZGRJbml0U2NyaXB0KHsgcGF0aDogJ2J1aWxkL2Rpc3Qvc3JjL1hybUV4LmpzJyB9KTtcbiAgdmFyIGVudjogQ1JNQ29uZmlnID0gSlNPTi5wYXJzZShwcm9jZXNzLmVudi5FTlZfVkFSX0pTT04pO1xuICBhd2FpdCBwYWdlLmdvdG8oZW52LkNPTlRBQ1RfUkVDT1JEX1VSTCk7XG4gIGF3YWl0IHBhZ2UuZ2V0QnlMYWJlbCgnRmlyc3QgTmFtZScpLndhaXRGb3IoeyBzdGF0ZTogJ3Zpc2libGUnIH0pO1xuICBhd2FpdCBnZXRNb2RlbChwYWdlKTtcbn0pO1xudGVzdC5kZXNjcmliZSgnVGVzdCBGaWVsZCBDbGFzcycsICgpID0+IHtcbiAgdGVzdCgnR2V0IGFuZCBTZXQgVmFsdWUnLCBhc3luYyAoeyBwYWdlIH0pID0+IHtcbiAgICB2YXIgcmVzcG9uc2UgPSBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IHtcbiAgICAgIG1vZGVsLmZpZWxkcy5GaXJzdG5hbWUuVmFsdWUgPSAnSm9obic7XG4gICAgICByZXR1cm4gbW9kZWwuZmllbGRzLkZpcnN0bmFtZS5WYWx1ZTtcbiAgICB9KTtcbiAgICBleHBlY3QocmVzcG9uc2UpLnRvQmUoJ0pvaG4nKTsvL1Rlc3RcbiAgfSk7XG4gIHRlc3QoJ0hpZGUgYW5kIFNob3cgRmllbGQnLCBhc3luYyAoeyBwYWdlIH0pID0+IHtcbiAgICB2YXIgcmVzcG9uc2UgPSBhd2FpdCBwYWdlLmV2YWx1YXRlKCgpID0+IHtcbiAgICAgIG1vZGVsLmZpZWxkcy5GaXJzdG5hbWUuc2V0VmlzaWJsZShmYWxzZSk7XG4gICAgICBsZXQgaXNWaXNpYmxlOiBib29sZWFuO1xuICAgICAgbW9kZWwuZmllbGRzLkZpcnN0bmFtZS5jb250cm9scy5mb3JFYWNoKGMgPT4gaXNWaXNpYmxlID0gYy5nZXRWaXNpYmxlKCkpXG4gICAgICByZXR1cm4gaXNWaXNpYmxlO1xuICAgIH0pO1xuICAgIGV4cGVjdChyZXNwb25zZSkudG9CZShmYWxzZSk7XG5cbiAgICB2YXIgcmVzcG9uc2UyID0gYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XG4gICAgICBtb2RlbC5maWVsZHMuRmlyc3RuYW1lLnNldFZpc2libGUodHJ1ZSk7XG4gICAgICBsZXQgaXNWaXNpYmxlOiBib29sZWFuO1xuICAgICAgbW9kZWwuZmllbGRzLkZpcnN0bmFtZS5jb250cm9scy5mb3JFYWNoKGMgPT4gaXNWaXNpYmxlID0gYy5nZXRWaXNpYmxlKCkpXG4gICAgICByZXR1cm4gaXNWaXNpYmxlO1xuICAgIH0pO1xuICAgIGV4cGVjdChyZXNwb25zZTIpLnRvQmUodHJ1ZSk7XG4gIH0pO1xufSk7XG5cbnR5cGUgUHJvbWlzZVR5cGU8VCBleHRlbmRzIFByb21pc2U8YW55Pj4gPSBUIGV4dGVuZHMgUHJvbWlzZTxpbmZlciBVPiA/IFUgOiBuZXZlcjtcbmRlY2xhcmUgZ2xvYmFsIHtcbiAgaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgbW9kZWw6IFByb21pc2VUeXBlPFJldHVyblR5cGU8dHlwZW9mIGdldE1vZGVsPj47XG4gIH1cbn1cbnZhciBtb2RlbDogUHJvbWlzZVR5cGU8UmV0dXJuVHlwZTx0eXBlb2YgZ2V0TW9kZWw+PjtcbmFzeW5jIGZ1bmN0aW9uIGdldE1vZGVsKHBhZ2U6IFBhZ2UpIHtcbiAgcmV0dXJuIGF3YWl0IHBhZ2UuZXZhbHVhdGUoKCkgPT4ge1xuICAgIFhybUV4LkZvcm0uZm9ybUNvbnRleHQgPSB3aW5kb3cuWHJtRXguRm9ybS5leGVjdXRpb25Db250ZXh0O1xuICAgIGNsYXNzIEZpZWxkcyB7XG4gICAgICBGaXJzdG5hbWUgPSBuZXcgWHJtRXguVGV4dEZpZWxkKFwiZmlyc3RuYW1lXCIpO1xuICAgICAgTGFzdG5hbWUgPSBuZXcgWHJtRXguVGV4dEZpZWxkKFwibGFzdG5hbWVcIik7XG4gICAgICBKb2JUaXRsZSA9IG5ldyBYcm1FeC5UZXh0RmllbGQoXCJqb2J0aXRsZVwiKTtcbiAgICAgIFByZWZlcnJlZENvbnRhY3RNZXRob2QgPSBuZXcgWHJtRXguT3B0aW9uc2V0RmllbGQoXG4gICAgICAgIFwicHJlZmVycmVkY29udGFjdG1ldGhvZGNvZGVcIixcbiAgICAgICAge1xuICAgICAgICAgIEFueTogMSxcbiAgICAgICAgICBFbWFpbDogMixcbiAgICAgICAgICBQaG9uZTogMyxcbiAgICAgICAgICBGYXg6IDQsXG4gICAgICAgICAgTWFpbDogNSxcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIEN1c3RvbWVyID0gbmV3IFhybUV4Lkxvb2t1cEZpZWxkKFwicGFyZW50Y3VzdG9tZXJpZFwiKTtcbiAgICAgIEJ1c2luZXNzUGhvbmUgPSBuZXcgWHJtRXguVGV4dEZpZWxkKFwidGVsZXBob25lMVwiKTtcbiAgICAgIEdlbmRlciA9IG5ldyBYcm1FeC5PcHRpb25zZXRGaWVsZChcImdlbmRlcmNvZGVcIik7XG4gICAgICBFbWFpbCA9IG5ldyBYcm1FeC5UZXh0RmllbGQoXCJlbWFpbGFkZHJlc3MxXCIpO1xuICAgICAgTW9iaWxlUGhvbmUgPSBuZXcgWHJtRXguVGV4dEZpZWxkKFwibW9iaWxlcGhvbmVcIik7XG4gICAgICBPd25lciA9IG5ldyBYcm1FeC5Mb29rdXBGaWVsZChcIm93bmVyaWRcIik7XG4gICAgICBEb05vdEVtYWlsID0gbmV3IFhybUV4LkJvb2xlYW5GaWVsZChcImRvbm90ZW1haWxcIik7XG4gICAgICBNYXJpdGFsU3RhdHVzID0gbmV3IFhybUV4Lk9wdGlvbnNldEZpZWxkKFwiZmFtaWx5c3RhdHVzY29kZVwiKTtcbiAgICAgIFNwb3VzZVBhcnRuZXJOYW1lID0gbmV3IFhybUV4LlRleHRGaWVsZChcInNwb3VzZXNuYW1lXCIpO1xuICAgICAgQmlydGhkYXkgPSBuZXcgWHJtRXguRGF0ZUZpZWxkKFwiYmlydGhkYXRlXCIpO1xuICAgIH1cbiAgICBjbGFzcyBUYWJzIHtcbiAgICAgIEdlbmVyYWwgPSBuZXcgWHJtRXguVGFiKFwidGFiMVwiLCB7XG4gICAgICAgIFNlY3Rpb24xOiBuZXcgWHJtRXguU2VjdGlvbihcInNlY3Rpb24xXCIpLFxuICAgICAgICBTZWN0aW9uMjogbmV3IFhybUV4LlNlY3Rpb24oXCJzZWN0aW9uMlwiKSxcbiAgICAgIH0pO1xuICAgICAgRGV0YWlscyA9IG5ldyBYcm1FeC5UYWIoXCJ0YWIyXCIsIHtcbiAgICAgICAgU2VjdGlvbjE6IG5ldyBYcm1FeC5TZWN0aW9uKFwic2VjdGlvbjFcIiksXG4gICAgICAgIFNlY3Rpb24yOiBuZXcgWHJtRXguU2VjdGlvbihcInNlY3Rpb24yXCIpLFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNsYXNzIEdyaWRzIHtcbiAgICAgIENvbnRhY3RTdWJncmlkID0gbmV3IFhybUV4LkdyaWRDb250cm9sKFwiVGVzdFwiKTtcbiAgICB9XG4gICAgdmFyIG1vZGVsID0ge1xuICAgICAgZmllbGRzOiBuZXcgRmllbGRzKCksXG4gICAgICB0YWJzOiBuZXcgVGFicygpLFxuICAgICAgZ3JpZHM6IG5ldyBHcmlkcygpLFxuICAgIH07XG4gICAgd2luZG93Lm1vZGVsID0gbW9kZWw7XG4gICAgcmV0dXJuIG1vZGVsO1xuICB9KTtcbn0iXX0=